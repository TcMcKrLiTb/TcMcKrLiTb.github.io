define(["exports","./_chunks/vendor-fee82cbd","./_chunks/encodePath-70d2cd88"],(function(e,t,i){"use strict";window.Vue=t.Vue;var a={computed:{...t.mapGetters$1(["getNavItemsByExtension"])},methods:{navigation_getMenuItems(e){return this.applicationsList.filter((t=>"extension"===t.type?this.getNavItemsByExtension(t.id).filter((t=>n(e,t))).length>0:n(e,t))).map((e=>{const t=this.$language.current;let i,a,n=e.title?e.title.en:e.name;e.title&&e.title[t]&&(n=e.title[t]),e.icon?e.icon.indexOf(".")<0?i=e.icon:a=e.icon:i="deprecated";const o={iconMaterial:i,iconUrl:a,title:n};return e.url?(o.url=e.url,o.target=["_blank","_self","_parent","_top"].includes(e.target)?e.target:"_blank"):e.path?o.path=e.path:o.path=`/${e.id}`,o}))}}};function n(e,t){return t.menu?e.includes(t.menu):e.includes(null)}const o={mixins:[a],props:{applicationsList:{type:Array,required:!1,default:()=>[]}},computed:{menuItems(){return this.navigation_getMenuItems([null,"apps","appSwitcher"])},applicationSwitcherLabel(){return this.$gettext("Application Switcher")}},mounted(){t.uikit.util.on("#app-switcher-dropdown","shown",(()=>{this.focusFirstLink()})),t.uikit.util.on("#app-switcher-dropdown","hidden",(()=>{this.$emit("closed"),this.focusMenuButton()}))},methods:{logout(){this.visible=!1,this.$store.dispatch("logout")},focusFirstLink(){setTimeout((()=>{this.$refs.menu.$el.querySelector("a:first-of-type").focus()}),500)},focusMenuButton(){this.$refs.menubutton.$el.focus()}}};var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("nav",{attrs:{"aria-label":e.$gettext("Main navigation")}},[i("oc-button",{directives:[{name:"oc-tooltip",rawName:"v-oc-tooltip",value:e.applicationSwitcherLabel,expression:"applicationSwitcherLabel"}],ref:"menubutton",staticClass:"oc-topbar-menu-burger",attrs:{id:"_appSwitcherButton",appearance:"raw","aria-label":e.applicationSwitcherLabel}},[i("oc-icon",{staticClass:"uk-flex",attrs:{name:"apps"}})],1),e._v(" "),i("oc-drop",{ref:"menu",staticClass:"uk-width-large",attrs:{"drop-id":"app-switcher-dropdown",toggle:"#_appSwitcherButton",mode:"click",options:{pos:"bottom-right",delayHide:0},"close-on-click":""}},[i("ul",{staticClass:"uk-grid-small uk-text-center",attrs:{"uk-grid":""}},e._l(e.menuItems,(function(t,a){return i("li",{key:"apps-menu-"+a,staticClass:"uk-width-1-3"},[t.url?i("a",{key:"apps-menu-external-link",attrs:{target:t.target,href:t.url}},[i("oc-icon",{attrs:{name:t.iconMaterial,size:"xlarge"}}),e._v(" "),i("span",{staticClass:"uk-display-block",domProps:{textContent:e._s(e.$gettext(t.title))}})],1):i("router-link",{key:"apps-menu-internal-link",attrs:{to:t.path}},[i("oc-icon",{attrs:{name:t.iconMaterial,size:"xlarge"}}),e._v(" "),i("span",{staticClass:"uk-display-block",domProps:{textContent:e._s(e.$gettext(t.title))}})],1)],1)})),0)])],1)};s._withStripped=!0;const r=t.normalizeComponent({render:s,staticRenderFns:[]},undefined,o,undefined,false,undefined,!1,void 0,void 0,void 0);const c={mixins:[a],props:{userId:{type:String,required:!0},userDisplayName:{type:String,required:!0},userEmail:{type:String,required:!1,default:null},applicationsList:{type:Array,required:!1,default:()=>[]}},computed:{menuItems(){return this.navigation_getMenuItems(["user"])}},watch:{visible(e){e?this.focusFirstLink():this.$emit("closed")}},methods:{logout(){this.visible=!1,setTimeout((()=>{this.$store.dispatch("logout")}))},focusFirstLink(){setTimeout((()=>{this.$refs.menuButton.$el.querySelector("a:first-of-type").focus()}),500)}}};var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.userId?i("nav",{attrs:{"aria-label":e.$gettext("Account menu")}},[i("oc-button",{ref:"menuButton",staticClass:"oc-topbar-personal uk-height-1-1 oc-pr-xs",attrs:{id:"_userMenuButton",appearance:"raw",variation:"passive","aria-label":e.$gettext("User Menu")}},[i("oc-grid",{attrs:{flex:""}},[i("avatar-image",{staticClass:"oc-topbar-personal-avatar uk-flex-inline uk-flex-center uk-flex-middle",attrs:{width:24,userid:e.userId,"user-name":e.userDisplayName}}),e._v(" "),i("div",{staticClass:"oc-topbar-personal-label oc-text-bold oc-ml-rm",domProps:{textContent:e._s(e.userDisplayName)}})],1)],1),e._v(" "),i("oc-drop",{ref:"menu",staticClass:"uk-width-auto",attrs:{"drop-id":"account-info-container",toggle:"#_userMenuButton",mode:"click","close-on-click":"",options:{pos:"bottom-right",delayHide:0}}},[i("ul",{staticClass:"uk-list"},[i("li",{staticClass:"uk-text-nowrap"},[i("oc-button",{attrs:{id:"oc-topbar-account-manage",type:"router-link",to:{path:"/account"},appearance:"raw","gap-size":"xsmall","justify-content":"left"}},[i("oc-icon",{attrs:{name:"portrait"}}),e._v(" "),i("translate",[e._v("Profile")])],1)],1),e._v(" "),e._l(e.menuItems,(function(t,a){return i("li",{key:"user-menu-"+a},[t.url?i("oc-button",{attrs:{type:"a",appearance:"raw","gap-size":"xsmall","justify-content":"left",target:t.target,href:t.url}},[i("oc-icon",{attrs:{name:t.iconMaterial}}),e._v(" "),i("translate",[e._v(e._s(t.title))])],1):i("oc-button",{attrs:{type:"router-link",appearance:"raw","gap-size":"xsmall","justify-content":"left",to:{path:t.path}}},[i("oc-icon",{attrs:{name:t.iconMaterial}}),e._v(" "),i("translate",[e._v(e._s(t.title))])],1)],1)})),e._v(" "),i("li",[i("oc-button",{attrs:{id:"oc-topbar-account-logout",appearance:"raw","gap-size":"xsmall","justify-content":"left"},on:{click:e.logout}},[i("oc-icon",{attrs:{name:"exit_to_app"}}),e._v(" "),i("translate",[e._v("Log out")])],1)],1)],2)])],1):e._e()};l._withStripped=!0;const d=t.normalizeComponent({render:l,staticRenderFns:[]},undefined,c,undefined,false,undefined,!1,void 0,void 0,void 0);const u={computed:{...t.mapGetters$1(["activeNotifications","configuration"]),notificationsLabel(){return this.$gettext("Notifications")}},methods:{...t.mapActions$1(["deleteNotification","showMessage"]),...t.mapActions$1("Files",["loadFolder"]),executeRequest(e,t,i,a){this.$client.requests.ocs({service:"apps/"+e,action:t.substr(t.lastIndexOf("api")),method:i}).then((e=>{this.deleteNotification({client:this.$client,notification:a}),e.json().then((e=>{e.ocs.data.forEach((e=>{const t=e.path.substr(0,e.path.lastIndexOf("/")+1);t===(this.$route.params.item?this.$route.params.item:"/")&&this.reloadFilesList(t)}))}))}))},reloadFilesList(e){this.loadFolder({client:this.$client,absolutePath:e,$gettext:this.$gettext,routeName:this.$route.name}).catch((e=>{this.showMessage({title:this.$gettext("Loading folder failed…"),desc:e.message,status:"danger"})}))}}};var p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"oc-notification"}},[i("oc-button",{directives:[{name:"oc-tooltip",rawName:"v-oc-tooltip",value:e.notificationsLabel,expression:"notificationsLabel"}],attrs:{id:"oc-notification-bell",appearance:"raw","aria-label":e.notificationsLabel}},[i("oc-icon",{staticClass:"oc-cursor-pointer uk-flex uk-flex-middle",attrs:{name:"bell"}})],1),e._v(" "),i("oc-drop",{staticClass:"uk-overflow-auto uk-width-3-4 uk-width-large@s",attrs:{id:"oc-notification-drop","drop-id":"notifications-dropdown",toggle:"#oc-notification-bell",mode:"click",options:{pos:"bottom-right",delayHide:0}}},e._l(e.activeNotifications,(function(t,a){return i("div",{key:a,staticClass:"uk-width-1-1"},[i("h4",{domProps:{textContent:e._s(t.subject)}}),e._v(" "),t.message?i("p",{staticClass:"uk-text-small"},[e._v(e._s(t.message))]):e._e(),e._v(" "),i("p",[t.link?i("a",{staticClass:"uk-link",attrs:{href:t.link,target:"_blank"}},[e._v(e._s(t.link))]):e._e()]),e._v(" "),i("div",{staticClass:"uk-button-group uk-width-1-1 uk-flex-right"},[0!==t.actions.length?e._l(t.actions,(function(n,o){return i("oc-button",{key:a+"-"+o,staticClass:"oc-ml-s",attrs:{size:"small",variation:n.primary?"primary":"passive",appearance:"filled"},on:{click:function(i){return i.preventDefault(),e.executeRequest(t.app,n.link,n.type,t.notification_id)}}},[e._v(e._s(n.label))])})):i("oc-button",{attrs:{id:"resolve-notification-button",size:"small"},on:{"~click":function(i){return i.preventDefault(),e.deleteNotification({client:e.$client,notification:t.notification_id})}}},[e._v("\n          Mark as read\n        ")])],2),e._v(" "),a+1!==e.activeNotifications.length?i("hr"):e._e()])})),0)],1)};p._withStripped=!0;const m=t.normalizeComponent({render:p,staticRenderFns:[]},undefined,u,"data-v-7ec744b6",false,undefined,!1,void 0,void 0,void 0);const h={name:"SearchBar",data:()=>({isLoadingSearchResults:!1}),computed:{searchLabel(){return this.$gettext("Enter search query")},displaySearchButtonLabel(){return this.$gettext("Open search bar")}},watch:{$route(){this.clearSearchBarValue()}},methods:{...t.mapActions$1("Files",["searchForFile","resetSearch"]),search(e){e?(this.isLoadingSearchResults=!0,this.searchForFile({searchTerm:e,client:this.$client}).catch((e=>{this.showMessage({title:this.$gettext("Search failed"),desc:e.message,status:"danger"})})).finally((()=>{this.isLoadingSearchResults=!1}))):this.resetSearch()},clearSearchBarValue(){(this.$refs.globalSearchBar?this.$refs.globalSearchBar:this.$refs.mobileSearch).query=""},focusMobileSearchInput(){setTimeout((()=>{this.$refs.mobileSearch.$el.querySelector("input").focus()}),50)}}};var g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("oc-search-bar",{ref:"globalSearchBar",staticClass:"uk-width-large uk-visible@m",attrs:{id:"files-global-search-bar",label:e.searchLabel,placeholder:e.searchLabel,loading:e.isLoadingSearchResults},on:{search:e.search,clear:e.resetSearch}}),e._v(" "),i("oc-button",{key:"mobile-search-button",staticClass:"uk-hidden@m",attrs:{id:"files-open-search-btn","aria-label":e.displaySearchButtonLabel},on:{click:e.focusMobileSearchInput}},[i("oc-icon",{attrs:{name:"search"}})],1),e._v(" "),i("oc-drop",{staticClass:"oc-m-rm",attrs:{"drop-id":"oc-topbar-search-mobile",toggle:"#files-open-search-btn",mode:"click",options:{delayHide:"0"}}},[i("oc-search-bar",{ref:"mobileSearch",attrs:{label:e.searchLabel,loading:e.isLoadingSearchResults},on:{search:e.search,clear:e.resetSearch}})],1)],1)};g._withStripped=!0;const f=t.normalizeComponent({render:g,staticRenderFns:[]},undefined,h,undefined,false,undefined,!1,void 0,void 0,void 0);const v={name:"FeedbackLink",computed:{href:()=>"https://owncloud.com/web-design-feedback",ariaLabel(){return this.$gettext("ownCloud feedback survey")},description(){return this.$gettext("Provide your feedback: We'd like to improve the web design and would be happy to hear your feedback. Thank you! Your ownCloud team.")}}};var b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("oc-button",{directives:[{name:"oc-tooltip",rawName:"v-oc-tooltip",value:e.description,expression:"description"}],attrs:{type:"a",href:e.href,target:"_blank",appearance:"raw","aria-label":e.ariaLabel,"aria-describedby":"oc-feedback-link-description"}},[i("oc-icon",{attrs:{name:"feedback"}})],1),e._v(" "),i("p",{staticClass:"oc-invisible-sr",attrs:{id:"oc-feedback-link-description"},domProps:{textContent:e._s(e.description)}})],1)};b._withStripped=!0;const _={components:{FeedbackLink:t.normalizeComponent({render:b,staticRenderFns:[]},undefined,v,undefined,false,undefined,!1,void 0,void 0,void 0),Notifications:m,ApplicationsMenu:r,UserMenu:d,SearchBar:f},props:{userId:{type:String,required:!1,default:""},userDisplayName:{type:String,required:!1,default:""},applicationsList:{type:Array,required:!1,default:()=>[]},hasAppNavigation:{type:Boolean,required:!1,default:!1},activeNotifications:{type:[Array,Boolean],required:!1,default:()=>[]}},computed:{...t.mapGetters$1(["configuration"]),isSearchDisabled(){return!0===this.configuration.options.hideSearchBar||!0===this.$route.meta.hideSearchBar},isFeedbackLinkEnabled(){return!this.configuration.options.disableFeedbackLink}},methods:{toggleAppNavigationVisibility(){this.$emit("toggleAppNavigationVisibility")}}};var k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("header",{staticClass:"oc-topbar uk-flex uk-flex-middle uk-flex-wrap oc-border-b oc-p-s",attrs:{"aria-label":e.$gettext("Top bar")}},[i("oc-grid",{attrs:{gutter:"medium",flex:""}},[i("div",{staticClass:"uk-hidden@l"},[i("oc-button",{staticClass:"oc-m-s oc-app-navigation-toggle",attrs:{appearance:"raw","aria-label":e.$gettext("Open navigation menu")},on:{click:e.toggleAppNavigationVisibility}},[i("oc-icon",{attrs:{name:"menu"}})],1)],1),e._v(" "),e.isSearchDisabled?e._e():i("search-bar")],1),e._v(" "),i("oc-grid",{staticClass:"uk-width-expand uk-flex-right oc-m-rm",attrs:{flex:"",gutter:"small"}},[e.isFeedbackLinkEnabled?i("feedback-link"):e._e(),e._v(" "),e.activeNotifications.length?i("notifications"):e._e(),e._v(" "),e.applicationsList.length>0?i("applications-menu",{attrs:{"applications-list":e.applicationsList}}):e._e(),e._v(" "),i("user-menu",{attrs:{"user-id":e.userId,"user-display-name":e.userDisplayName,"applications-list":e.applicationsList}})],1)],1)};k._withStripped=!0;const w=t.normalizeComponent({render:k,staticRenderFns:[]},undefined,_,"data-v-d0a1db9e",false,undefined,!1,void 0,void 0,void 0);const S={props:{activeMessages:{type:Array,required:!1,default:()=>[]}},computed:{$_ocMessages_limited(){return this.activeMessages?this.activeMessages.slice(0,5):[]}},methods:{deleteMessage(e){this.$emit("deleteMessage",e)}}};var y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("oc-notifications",[i("transition-group",{attrs:{name:"oc-alerts-transition",tag:"div"}},e._l(e.$_ocMessages_limited,(function(t){return i("oc-notification-message",{key:t.id,staticClass:"uk-width-large",attrs:{title:e.$gettext(t.title),message:e.$gettext(t.desc),status:t.status},on:{close:function(i){return e.deleteMessage(t)}}})})),1)],1)};y._withStripped=!0;const E=t.normalizeComponent({render:y,staticRenderFns:[]},undefined,S,undefined,false,undefined,!1,void 0,void 0,void 0);const I={props:{target:{type:String,required:!0}},computed:{targetElement(){return document.getElementById(this.target)}},methods:{skipToTarget(){this.targetElement.setAttribute("tabindex","-1"),this.targetElement.focus(),this.targetElement.scrollIntoView()}}};var x=function(){var e=this,t=e.$createElement;return(e._self._c||t)("button",{staticClass:"skip-button",on:{click:e.skipToTarget}},[e._t("default")],2)};x._withStripped=!0;const C={components:{MessageBar:E,TopBar:w,SkipTo:t.normalizeComponent({render:x,staticRenderFns:[]},undefined,I,"data-v-7d862d28",false,undefined,!1,void 0,void 0,void 0),FocusTrap:t.FocusTrap},data:()=>({appNavigationVisible:!1,$_notificationsInterval:null,windowWidth:0,announcement:""}),computed:{...t.mapState(["route","user","modal","sidebar"]),...t.mapGetters$1(["configuration","activeNotifications","activeMessages","capabilities","apps","getSettingsValue","getNavItemsByExtension","getExtensionsWithNavItems"]),applicationsList(){const e=[];return this.getExtensionsWithNavItems.forEach((t=>{e.push({...this.apps[t],type:"extension"})})),this.configuration.applications.forEach((t=>{e.push({...t,type:"link"})})),e},showHeader(){return!0!==this.$route.meta.hideHeadbar},favicon(){return this.configuration.theme.logo.favicon},logoImage(){return this.configuration.theme.logo.sidebar},sidebarLogoAlt(){return this.$gettext("Navigate to all files page")},sidebarNavItems(){if(!this.user.token)return[];const e=this.getNavItemsByExtension(this.currentExtension);return e?(e.filter((e=>void 0!==this.capabilities&&(void 0===e.enabled||e.enabled(this.capabilities)))),e.map((e=>({...e,name:this.$gettext(e.name),active:this.$route.name===e.route.name})))):[]},sidebarClasses(){return this.appNavigationVisible?"":"uk-visible@l"},isSidebarFixed(){return this.windowWidth<=960},isSidebarVisible(){return 0!==this.sidebarNavItems.length&&(this.windowWidth>=1200||this.appNavigationVisible)},appNavigationAnimation(){return this.windowWidth>1200?null:this.windowWidth>960?"push-right":"fade"},selectedLanguage(){return this.getSettingsValue({extension:"ocis-accounts",bundle:"profile",setting:"language"})}},watch:{$route:{immediate:!0,handler:function(e){this.announceRouteChange(e),document.title=this.extractPageTitleFromRoute(e),this.appNavigationVisible=!1}},capabilities(e){e&&e.notifications&&(this.$nextTick((()=>{this.$_updateNotifications()})),this.$_notificationsInterval=setInterval((()=>{this.$_updateNotifications()}),3e4))},selectedLanguage:{immediate:!0,handler(e){let t=this.$language.defaultLanguage;null!==e&&e.listValue.values.length>0&&(t=e.listValue.values[0].stringValue),t&&(this.$language.current=t,document.documentElement.lang=t)}}},beforeDestroy(){window.removeEventListener("resize",this.onResize)},destroyed(){this.$_notificationsInterval&&clearInterval(this.$_notificationsInterval)},metaInfo(){const e={};return this.favicon&&(e.link=[{rel:"icon",href:this.favicon}]),e},mounted(){this.$nextTick((()=>{window.addEventListener("resize",this.onResize),this.onResize()}))},beforeMount(){this.initAuth()},methods:{...t.mapActions$1(["initAuth","fetchNotifications","deleteMessage"]),focusModal(e,t){this.focus({revert:"beforeDestroy"===t})},hideAppNavigation(){this.appNavigationVisible=!1},toggleAppNavigationVisibility(){this.appNavigationVisible=!this.appNavigationVisible,this.appNavigationVisible&&this.$nextTick((()=>{this.$refs.navigationSidebarLogo.$el.focus()}))},$_updateNotifications(){this.fetchNotifications(this.$client).catch((e=>{console.error("Error while loading notifications: ",e),clearInterval(this.$_notificationsInterval)}))},$_deleteMessage(e){this.deleteMessage(e)},onResize(){const e=window.innerWidth;e>=1200&&(this.appNavigationVisible=!1),this.windowWidth=e},handleNavSwipe(){this.windowWidth<=960||this.windowWidth>1200||(this.appNavigationVisible=!1)},announceRouteChange(e){const t=this.extractPageTitleFromRoute(e,!1),i=this.$gettext("Navigated to %{ pageTitle }");this.announcement=this.$gettextInterpolate(i,{pageTitle:t})},extractPageTitleFromRoute(e,t=!0){const i=[e.meta.title?this.$gettext(e.meta.title):e.name];if(t&&i.push(this.configuration.theme.general.name),e.params.item)if(e.name.startsWith("files-")){const t=e.params.item.split("/").filter((e=>e.length));t.length&&i.unshift(t.pop())}else i.unshift(e.params.item);return i.join(" - ")}}};var A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"web"}},[i("oc-hidden-announcer",{attrs:{announcement:e.announcement,level:"polite"}}),e._v(" "),i("skip-to",{attrs:{target:"main"}},[i("translate",[e._v("Skip to main")])],1),e._v(" "),e.user.isAuthenticated&&!e.user.userReady?i("div",{staticClass:"loading-overlay",style:{backgroundImage:"url("+e.configuration.theme.loginPage.backgroundImg+")"}},[i("oc-spinner",{staticClass:"uk-position-center",attrs:{size:"xlarge","aria-label":e.$gettext("Loading")}})],1):e.showHeader?i("div",{key:"core-content",staticClass:"uk-flex uk-flex-stretch",attrs:{id:"web-content"}},[i("transition",{attrs:{name:e.appNavigationAnimation}},[e.isSidebarVisible?i("focus-trap",{attrs:{active:e.isSidebarFixed&&e.appNavigationVisible}},[i("oc-sidebar-nav",{directives:[{name:"show",rawName:"v-show",value:e.isSidebarVisible,expression:"isSidebarVisible"},{name:"touch",rawName:"v-touch:swipe.left",value:e.handleNavSwipe,expression:"handleNavSwipe",arg:"swipe",modifiers:{left:!0}}],staticClass:"oc-app-navigation",class:e.sidebarClasses,attrs:{id:"web-nav-sidebar","accessible-label-header":e.$gettext("Sidebar header"),"accessible-label-nav":e.$gettext("Sidebar navigation menu"),"accessible-label-footer":e.$gettext("Sidebar footer")},scopedSlots:e._u([{key:"header",fn:function(){return[i("div",{staticClass:"uk-text-center"},[e.isSidebarFixed?i("oc-button",{staticClass:"web-sidebar-btn-close",attrs:{variation:"inverse",appearance:"raw","aria-label":e.$gettext("Close sidebar")},on:{click:e.toggleAppNavigationVisibility}},[i("oc-icon",{attrs:{name:"close"}})],1):e._e(),e._v(" "),i("router-link",{ref:"navigationSidebarLogo",attrs:{to:"/"}},[i("oc-logo",{attrs:{src:e.logoImage,alt:e.sidebarLogoAlt}})],1)],1)]},proxy:!0},{key:"nav",fn:function(){return[i("oc-list",e._l(e.sidebarNavItems,(function(t){return i("oc-sidebar-nav-item",{key:t.route.path,attrs:{active:t.active,target:t.route.path,icon:t.icon||t.iconMaterial}},[e._v("\n                "+e._s(t.name)+"\n              ")])})),1)]},proxy:!0},e.sidebar.sidebarFooterContentComponent?{key:"footer",fn:function(){return[i(e.sidebar.sidebarFooterContentComponent,{tag:"component"})]},proxy:!0}:null],null,!0)})],1):e._e()],1),e._v(" "),i("div",{staticClass:"uk-width-expand web-content-container"},[e.publicPage()||e.$route.meta.verbose?e._e():i("top-bar",{staticClass:"uk-width-expand",attrs:{id:"oc-topbar","applications-list":e.applicationsList,"active-notifications":e.activeNotifications,"user-id":e.user.username||e.user.id,"user-display-name":e.user.displayname},on:{toggleAppNavigationVisibility:e.toggleAppNavigationVisibility}}),e._v(" "),i("div",{attrs:{id:"main"}},[i("message-bar",{attrs:{"active-messages":e.activeMessages},on:{deleteMessage:e.$_deleteMessage}}),e._v(" "),i("router-view",{staticClass:"oc-app-container",attrs:{name:"app"}})],1)],1)],1):[i("router-view",{attrs:{name:"fullscreen"}})],e._v(" "),i("transition",{attrs:{"enter-active-class":"uk-animation-fade uk-animation-fast","leave-active-class":"uk-animation-fade uk-animation-reverse uk-animation-fast",name:"custom-classes-transition"}},[e.modal.displayed?i("oc-modal",{attrs:{variation:e.modal.variation,icon:e.modal.icon,title:e.modal.title,message:e.modal.message,"has-input":e.modal.hasInput,"input-label":e.modal.inputLabel,"input-disabled":e.modal.inputDisabled,"input-value":e.modal.inputValue,"input-description":e.modal.inputDescription,"input-error":e.modal.inputError,"button-cancel-text":e.modal.cancelText,"button-confirm-text":e.modal.confirmText,"button-confirm-disabled":e.modal.confirmDisabled||!!e.modal.inputError},on:{cancel:e.modal.onCancel,confirm:e.modal.onConfirm,input:e.modal.onInput,mounted:e.focusModal,beforeDestroy:e.focusModal}}):e._e()],1)],2)};A._withStripped=!0;const N=t.normalizeComponent({render:A,staticRenderFns:[]},undefined,C,undefined,false,undefined,!1,void 0,void 0,void 0);const T={name:"MissingConfigPage",computed:{...t.mapGetters$1(["configuration"]),backgroundImg(){return this.configuration.theme.loginPage.backgroundImg},logoImg(){return this.configuration.theme.logo.login}}};var L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"uk-height-1-1",style:{backgroundImage:"url("+e.backgroundImg+")"},attrs:{id:"Web"}},[i("div",{staticClass:"oc-login",attrs:{"uk-height-viewport":""}},[i("div",{staticClass:"oc-login-card uk-position-center"},[i("img",{staticClass:"oc-login-logo",attrs:{src:e.logoImg,alt:"","aria-hidden":!0}}),e._v(" "),i("div",{staticClass:"oc-login-card-body"},[i("h1",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-login-card-title"},[e._v("Missing or invalid config")]),e._v(" "),i("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Please check if the file config.json exists and is correct.")]),e._v(" "),i("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Also, make sure to check the browser console for more information.")])]),e._v(" "),i("div",{staticClass:"oc-login-card-footer"},[i("p",[i("translate",[e._v("For help visit our")]),e._v(" "),i("a",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{href:"https://owncloud.dev/clients/web",target:"_blank"}},[e._v("documentation")]),e._v(" "),i("translate",[e._v("or join our")]),e._v(" "),i("a",{directives:[{name:"translate",rawName:"v-translate"}],attrs:{href:"https://talk.owncloud.com/channel/web",target:"_blank"}},[e._v("chat")]),e._v(".\n        ")],1)])])])])};L._withStripped=!0;const $=t.normalizeComponent({render:L,staticRenderFns:[]},undefined,T,undefined,false,undefined,!1,void 0,void 0,void 0);var O={state:{messages:[],notifications:{loading:!0,failed:!1,data:[]},quickActions:{}},actions:{toggleSidebar(e,t){e.commit("TOGGLE_SIDEBAR",t)},showMessage({commit:e},t){e("ENQUEUE_MESSAGE",t)},deleteMessage(e,t){e.commit("REMOVE_MESSAGE",t)},fetchNotifications:(e,t)=>(e.commit("LOADING_NOTIFICATIONS",!0),t.requests.ocs({service:"apps/notifications",action:"api/v1/notifications"}).then((t=>{"0"!==t.headers.get("Content-Length")&&t.json().then((i=>{t.ok?e.commit("UPDATE_NOTIFICATIONS",i.ocs.data):e.commit("ERROR_NOTIFICATIONS",i.ocs.meta.message),e.commit("LOADING_NOTIFICATIONS",!1)}))})).catch((t=>{e.commit("ERROR_NOTIFICATIONS",t),e.commit("LOADING_NOTIFICATIONS",!1)}))),deleteNotification(e,{client:t,notification:i}){t.requests.ocs({service:"apps/notifications",action:"api/v1/notifications/"+i,method:"DELETE"}).then((t=>{t.ok?e.commit("DELETE_NOTIFICATION",i):e.commit("ERROR_NOTIFICATIONS",t.ocs.meta.status)})).catch((t=>{e.commit("ERROR_NOTIFICATIONS",t)}))}},mutations:{ENQUEUE_MESSAGE(e,t){t.id||(t.id=Math.random().toString(36).slice(2,-1)),e.messages.push(t)},REMOVE_MESSAGE(e,t){e.messages.splice(e.messages.indexOf(t),1)},LOADING_NOTIFICATIONS(e,t){e.notifications.loading=t},ERROR_NOTIFICATIONS(e,t){e.notifications.failed=t},UPDATE_NOTIFICATIONS(e,t){e.notifications.data=t},DELETE_NOTIFICATION(e,t){const i=e.notifications.data.filter((e=>e.notification_id!==t));e.notifications.data=i},ADD_QUICK_ACTIONS(e,t){e.quickActions=Object.assign(e.quickActions,t)}},getters:{activeMessages:e=>e.messages,activeNotifications:e=>!(!e.notifications.data.length||e.notifications.failed)&&e.notifications.data,isOcis:(e,t,i)=>"reva"===i.user.version.edition}};var F={state:{file:{path:"",edit:!1},fileEditors:[],newFileHandlers:[],fileSideBars:[],customFilesListIndicators:[],meta:{}},actions:{openFile:(e,t)=>new Promise(((i,a)=>{const n=t.filePath;e.commit("FETCH_FILE",n);const o=t.client||!1;o?o.files.getFileContents(n).then(i).catch(a):i()})),registerApp({commit:e},t){e("REGISTER_APP",t)},addFileAction({commit:e},t){e("ADD_FILE_ACTION",t)}},mutations:{REGISTER_APP(e,t){if(t.extensions&&t.extensions.forEach((i=>{const a={app:t.id,icon:i.icon,newTab:i.newTab||!1,routeName:i.routeName,routes:i.routes||[],extension:i.extension,handler:i.handler};e.fileEditors.push(a),i.newFileMenu&&(i.newFileMenu.ext=i.extension,i.newFileMenu.action=a,e.newFileHandlers.push(i.newFileMenu))})),t.fileSideBars){const i=e.fileSideBars;t.fileSideBars.forEach((e=>{i.push(e)})),e.fileSideBars=i}if(t.filesListIndicators){const i=e.customFilesListIndicators;t.filesListIndicators.forEach((e=>{i.push(e)})),e.customFilesListIndicators=i}if(!t.id)return;const i={name:t.name||t.id,id:t.id,icon:t.icon||"check_box_outline_blank"};e.meta[i.id]=i},FETCH_FILE(e,t){e.file.path=t},LOAD_EXTENSION_CONFIG(e,{id:t,config:i}){const a=[...e.fileEditors];for(const e of a)e.app===t&&(e.config=i);if(e.fileEditors=a,e.meta[t]){const a={...e.meta};a[t].config=i,e.meta=a}}},getters:{appIds:e=>Object.keys(e.meta),apps:e=>e.meta,activeFile:e=>e.file,newFileHandlers:e=>e.newFileHandlers,fileSideBars:e=>e.fileSideBars,customFilesListIndicators:e=>e.customFilesListIndicators}};var R={state:{state:null,server:"",auth:{clientId:"",apiUrl:"",authUrl:"",metaDataUrl:""},openIdConnect:{authority:""},theme:{general:{name:"",slogan:"",helpDeskText:"",helpDeskLink:"",helpDeskLinkText:"ownCloud Central"},logo:{sidebar:"",favicon:"",login:"",notFound:""},loginPage:{autoRedirect:!0,backgroundImg:""}},options:{defaultExtension:"files",hideSearchBar:!1,homeFolder:"",disablePreviews:!1,previewFileExtensions:[]}},actions:{loadConfig({commit:e},t){e("LOAD_CONFIG",t),t.external_apps&&t.external_apps.forEach((t=>{void 0!==t.config&&e("LOAD_EXTENSION_CONFIG",{id:t.id,config:t.config},{root:!0})}))},loadTheme(e,{theme:t}){e.commit("LOAD_THEME",t)}},mutations:{LOAD_CONFIG(e,t){e.server=t.server.endsWith("/")?t.server:t.server+"/",e.auth=t.auth,e.openIdConnect=t.openIdConnect,e.uploadChunkSize=void 0===t.uploadChunkSize?1/0:t.uploadChunkSize,e.state=void 0===t.state?"working":t.state,e.applications=void 0===t.applications?[]:t.applications,void 0!==t.options&&(e.options={...e.options,...t.options}),t.corrupted&&(e.corrupted=t.corrupted)},LOAD_THEME(e,i){e.theme=t.merge({},e.theme,i)}},getters:{configuration:e=>e,previewFileExtensions:e=>{const t=e.options.previewFileExtensions;return(Array.isArray(t)?t:[]).filter(Boolean).map((e=>e.toLowerCase()))},homeFolder:(e,i)=>{if(t.isEmpty(e.options.homeFolder))return"/";const a=function(e,i){const a=/{{(.*?)}}/g,n=e.match(a);n&&n.forEach((a=>{const n=/{{substr\s([0-9]+)\s([0-9]+)\s\.(.*)}}/,o=a.match(n);if(!t.isEmpty(o)&&o.length>=4){const t=parseInt(o[1],10),n=parseInt(o[2],10),s=P(o[3],i);return void(e=e.replace(a,s.substring(t,t+n)))}const s=/{{\.(.*)}}/,r=a.match(s);!t.isEmpty(r)&&r.length>=2&&(e=e.replace(a,P(r[1],i)))}));return e}(e.options.homeFolder,i.user);return a.indexOf("//")>-1?"/":a},theme:e=>e.theme}};function P(e,t){return t[e.toLowerCase()]||""}function D(e){if(e){const i=new t.oidcClient_min.WebStorageStateStore({prefix:"oc_oAuth",store:sessionStorage});let a=window.location.href.split("#")[0];a.endsWith("/index.html")&&(a=a.substr(0,a.length-10));const n={userStore:i,redirect_uri:a+"oidc-callback.html",response_type:"code",response_mode:"query",scope:"openid profile offline_access",monitorSession:!1,post_logout_redirect_uri:a+"#/login",silent_redirect_uri:a+"oidc-silent-redirect.html",accessTokenExpiringNotificationTime:10,automaticSilentRenew:!0,filterProtocolClaims:!0,loadUserInfo:!0,logLevel:t.oidcClient_min.Log.INFO};e.openIdConnect&&e.openIdConnect.authority?Object.assign(n,e.openIdConnect):e.auth.metaDataUrl?Object.assign(n,{authority:e.auth.url,metadataUrl:e.auth.metaDataUrl,client_id:e.auth.clientId}):Object.assign(n,{authority:e.auth.url,metadata:{issuer:e.auth.url,authorization_endpoint:e.auth.authUrl,token_endpoint:e.auth.url,userinfo_endpoint:""},client_id:e.auth.clientId,response_type:"token",scope:"openid profile",loadUserInfo:!1});const o=new t.oidcClient_min.UserManager(n);return t.oidcClient_min.Log.logger=console,t.oidcClient_min.Log.level=n.logLevel,o.events.addUserSignedOut((function(){console.log("UserSignedOut：",arguments)})),{authenticate:()=>o.signinRedirect(),getToken(){const e=sessionStorage.getItem("oc_oAuth"+o._userStoreKey);if(e){const i=t.oidcClient_min.User.fromStorageString(e);if(i)return o.events.load(i,!1),i.access_token}return null},getStoredUserObject(){const e=sessionStorage.getItem("oc_oAuth"+o._userStoreKey);if(e){const i=t.oidcClient_min.User.fromStorageString(e);if(i)return o.events.load(i,!1),i}return null},isAuthenticated(){return null!==this.getToken()},createSignoutRequest:e=>new Promise(((t,i)=>{o.createSignoutRequest(e).then((e=>t(e.url))).catch((e=>i(e)))})),clearLoginState:()=>o.removeUser(),mgr:o,events:()=>o.events}}}const V={name:"LoginPage",data:()=>({loading:!1,initialized:!1}),computed:{...t.mapGetters$1(["configuration"]),pageTitle(){return this.$gettext(this.$route.meta.title)},$_productName(){return this.configuration.theme.general.name},logoImg(){return this.configuration.theme.logo.login},backgroundImg(){return this.configuration.theme.loginPage.backgroundImg}},created(){this.configuration.theme.loginPage.autoRedirect?this.login():this.initialized=!0},methods:{...t.mapActions$1(["login"])}};var M=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.initialized?i("div",{staticClass:"oc-login",style:{backgroundImage:"url("+e.backgroundImg+")"},attrs:{"uk-height-viewport":""}},[i("h1",{staticClass:"oc-invisible-sr"},[e._v(e._s(e.pageTitle))]),e._v(" "),i("div",{staticClass:"oc-login-card uk-position-center"},[i("img",{staticClass:"oc-login-logo",attrs:{src:e.logoImg,alt:"","aria-hidden":!0}}),e._v(" "),i("div",{staticClass:"oc-login-card-body"},[i("h2",{staticClass:"oc-login-card-title"},[i("translate",{attrs:{"translate-params":{productName:e.$_productName}}},[e._v("Welcome to %{productName}")])],1),e._v(" "),i("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("\n        Please click the button below to authenticate and get access to your data.\n      ")]),e._v(" "),i("oc-button",{staticClass:"oc-login-authorize-button",attrs:{id:"authenticate",size:"large",variation:"primary",appearance:"filled"},on:{click:function(t){return e.login()}}},[i("translate",[e._v("Login")])],1)],1),e._v(" "),i("div",{staticClass:"oc-login-card-footer"},[i("p",[e._v("\n        "+e._s(e.configuration.theme.general.slogan)+"\n      ")])])])]):e._e()};M._withStripped=!0;const U=t.normalizeComponent({render:M,staticRenderFns:[]},undefined,V,undefined,false,undefined,!1,void 0,void 0,void 0);const B={name:"OidcCallbackPage",data:()=>({error:!1}),computed:{...t.mapGetters$1(["configuration"]),pageTitle(){return this.$gettext(this.$route.meta.title)},backgroundImg(){return this.configuration.theme.loginPage.backgroundImg},logoImg(){return this.configuration.theme.logo.login}},mounted(){this.$nextTick((()=>{if(this.$route.query.error)return this.error=!0,void console.warn("OAuth error: "+this.$route.query.error+" - "+this.$route.query.error_description);"/oidc-silent-redirect"===this.$route.path?this.signinSilentCallback():this.callback()}))},methods:{...t.mapActions$1(["callback","signinSilentCallback"])}};var z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"oc-login",style:{backgroundImage:"url("+e.backgroundImg+")"},attrs:{"uk-height-viewport":""}},[i("h1",{staticClass:"oc-invisible-sr"},[e._v(e._s(e.pageTitle))]),e._v(" "),i("div",{staticClass:"oc-login-card uk-position-center"},[i("img",{staticClass:"oc-login-logo",attrs:{src:e.logoImg,alt:"","aria-hidden":!0}}),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"oc-login-card-body"},[i("h2",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-login-card-title"},[e._v("Authentication failed")]),e._v(" "),i("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Please contact the administrator if this error persists.")])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.error,expression:"!error"}],staticClass:"oc-login-card-body"},[i("h3",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-login-card-title"},[e._v("Redirecting")]),e._v(" "),i("p",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Please wait a while. You are being redirected.")])]),e._v(" "),i("div",{staticClass:"oc-login-card-footer"},[i("p",[e._v(e._s(e.configuration.theme.general.slogan))])])])])};z._withStripped=!0;const q=t.normalizeComponent({render:z,staticRenderFns:[]},undefined,B,undefined,false,undefined,!1,void 0,void 0,void 0);const G={name:"AccessDeniedPage",computed:{...t.mapGetters$1(["configuration"]),pageTitle(){return this.$gettext(this.$route.meta.title)},helpDeskText(){if(this.configuration.theme.general.helpDeskText&&this.configuration.theme.general.helpDeskText.en){const e=this.$language.current;return this.configuration.theme.general.helpDeskText[e]?this.configuration.theme.general.helpDeskText[e]:this.configuration.theme.general.helpDeskText.en}return this.$gettext("Please contact your administrator if you think this message shows up in error.")},helpDeskLink(){return this.configuration.theme.general.helpDeskLink?this.configuration.theme.general.helpDeskLink:""},helpDeskLinkText(){return this.configuration.theme.general.helpDeskLinkText?this.configuration.theme.general.helpDeskLinkText:""},logoImg(){return this.configuration.theme.logo.login},backgroundImg(){return this.configuration.theme.loginPage.backgroundImg}},methods:{...t.mapActions$1(["logout"]),performLogout(e){"exitAnchor"===e.target.id&&this.logout()}}};var j=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"oc-login",style:{backgroundImage:"url("+e.backgroundImg+")"},attrs:{"uk-height-viewport":""}},[i("h1",{staticClass:"oc-invisible-sr"},[e._v(e._s(e.pageTitle))]),e._v(" "),i("div",{staticClass:"oc-login-card uk-position-center"},[i("img",{staticClass:"oc-login-logo",attrs:{src:e.logoImg,alt:"","aria-hidden":!0}}),e._v(" "),i("div",{staticClass:"oc-login-card-body uk-width-large"},[i("h3",{staticClass:"oc-login-card-title"},[i("span",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("Login Error")])]),e._v(" "),i("h4",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-mb-m"},[e._v("\n        You are not allowed to use this application.\n      ")]),e._v(" "),i("div",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-mb-m",on:{click:e.performLogout}},[e._v("\n        If you like to login with a different user please proceed to "),i("a",{attrs:{id:"exitAnchor"}},[e._v("exit")]),e._v(".\n      ")]),e._v(" "),i("div",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-m-rm"},[i("strong",[e._v("Attention:")]),e._v(" this will log you out from all applications you are running in\n        this browser with your current user.\n      ")])]),e._v(" "),i("div",{staticClass:"oc-login-card-footer uk-width-large"},[i("p",[e._v("\n        "+e._s(e.helpDeskText)+"\n        "),e.helpDeskLink?i("a",{attrs:{href:e.helpDeskLink},domProps:{textContent:e._s(e.helpDeskLinkText)}}):e._e()])])])])};j._withStripped=!0;const H=t.normalizeComponent({render:j,staticRenderFns:[]},undefined,G,undefined,false,undefined,!1,void 0,void 0,void 0);const W={name:"Personal",data:()=>({loading:!0,groups:[]}),computed:{...t.mapGetters$1(["user","configuration","getNavItemsByExtension","isOcis"]),pageTitle(){return this.$gettext(this.$route.meta.title)},editUrl(){return this.isOcis?null:this.configuration.server.replace(/\/$/,"")+"/index.php/settings/personal"},editRoute(){const e=this.getNavItemsByExtension("settings");return e.length>0?e[0].route||{}:null},groupNames(){return this.groups.join(", ")}},mounted(){this.$_oc_settingsAccount_getGroup()},methods:{$_oc_settingsAccount_getGroup(){this.$client.users.getUserGroups(this.user.id).then((e=>{this.groups=e,this.loading=!1}))}}};var Y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"uk-width-1-1 uk-container oc-p"},[e.loading?i("div",{staticClass:"uk-flex uk-flex-between uk-flex-middle"},[i("h1",{staticClass:"oc-page-title"},[e._v(e._s(e.pageTitle))]),e._v(" "),i("oc-loader")],1):[i("div",{staticClass:"uk-flex uk-flex-between uk-flex-middle"},[i("h1",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-page-title",attrs:{id:"account-page-title"}},[e._v("Account")]),e._v(" "),e.editUrl?i("oc-button",{attrs:{variation:"primary",type:"a",href:e.editUrl}},[i("oc-icon",{attrs:{name:"edit"}}),e._v(" "),i("translate",[e._v("Edit")])],1):e.editRoute?i("oc-button",{attrs:{variation:"primary",type:"router-link",to:e.editRoute}},[i("oc-icon",{attrs:{name:"edit"}}),e._v(" "),i("translate",[e._v("Edit")])],1):e._e()],1),e._v(" "),i("hr"),e._v(" "),i("h2",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"oc-text-bold oc-text-initial oc-mb"},[e._v("Account Information")]),e._v(" "),i("dl",{staticClass:"account-page-info uk-flex uk-flex-wrap"},[i("div",{staticClass:"oc-mb uk-width-1-2@s"},[i("dt",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"account-page-info-username uk-text-normal oc-text-muted"},[e._v("\n          Username\n        ")]),e._v(" "),i("dd",[e._v("\n          "+e._s(e.user.username||e.user.id)+"\n        ")])]),e._v(" "),e.user.username&&e.user.id?i("div",[i("dt",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"account-page-info-userid uk-text-normal oc-text-muted"},[e._v("\n          User ID\n        ")]),e._v(" "),i("dd",[e._v("\n          "+e._s(e.user.id)+"\n        ")])]):e._e(),e._v(" "),i("div",{staticClass:"oc-mb uk-width-1-2@s"},[i("dt",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"account-page-info-displayname uk-text-normal oc-text-muted"},[e._v("\n          Display name\n        ")]),e._v(" "),i("dd",[e._v("\n          "+e._s(e.user.displayname)+"\n        ")])]),e._v(" "),i("div",{staticClass:"oc-mb uk-width-1-2@s"},[i("dt",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"account-page-info-email uk-text-normal oc-text-muted"},[e._v("\n          Email\n        ")]),e._v(" "),i("dd",[e.user.email?[e._v(e._s(e.user.email))]:i("span",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("No email has been set up")])],2)]),e._v(" "),i("div",{staticClass:"oc-mb uk-width-1-2@s"},[i("dt",{directives:[{name:"translate",rawName:"v-translate"}],staticClass:"account-page-info-groups uk-text-normal oc-text-muted",on:{click:e.$_oc_settingsAccount_getGroup}},[e._v("\n          Group memberships\n        ")]),e._v(" "),i("dd",[e.groupNames?i("span",[e._v(e._s(e.groupNames))]):i("span",{directives:[{name:"translate",rawName:"v-translate"}]},[e._v("You are not part of any group")])])])])]],2)};Y._withStripped=!0;const K=t.normalizeComponent({render:Y,staticRenderFns:[]},undefined,W,undefined,false,undefined,!1,void 0,void 0,void 0);t.Vue.use(t.VueRouter);const Q=new t.VueRouter({routes:[{path:"/login",name:"login",components:{fullscreen:U},meta:{auth:!1,hideHeadbar:!0,title:"Login"}},{path:"/oidc-callback",components:{fullscreen:q},meta:{auth:!1,hideHeadbar:!0,title:"Oidc callback"}},{path:"/oidc-silent-redirect",components:{fullscreen:q},meta:{auth:!1,hideHeadbar:!0,title:"Oidc redirect"}},{path:"/f/:fileId",name:"privateLink",redirect:"/files/private-link/:fileId",meta:{hideHeadbar:!0,title:"Private link"}},{path:"/s/:token",name:"publicLink",redirect:"/files/public-link/:token",meta:{auth:!1,hideHeadbar:!0,title:"Public link"}},{path:"/access-denied",name:"accessDenied",components:{fullscreen:H},meta:{auth:!1,hideHeadbar:!0,title:"Access denied"}},{path:"/account",name:"account",components:{app:K},meta:{title:"Account"}}]});Q.beforeEach((function(e,i,a){const n=t.Vue.$store,o=n.getters.isAuthenticated;let s=!0;if(!1===e.meta.auth&&(s=!1),s)if(o){const e=n.getters.urlBeforeLogin;n.dispatch("saveUrlBeforeLogin",null),e?a(e):a()}else n.dispatch("saveUrlBeforeLogin",e.fullPath),a("/login");else a()}));const X={name:"SidebarQuota",computed:{...t.mapGetters$1(["quota"]),usedQuota(){return e=(e=this.quota.used)<0?0:e,isNaN(e)?"?":t.filesize_min(e,{round:e<1048576?0:1});var e}}};var Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"uk-text-center"},[i("oc-progress",{staticClass:"oc-mb-xs",attrs:{value:e.quota.relative,max:100,size:"small"}}),e._v(" "),i("translate",{staticClass:"oc-light",attrs:{"translate-params":{used:e.usedQuota,total:e.quota.definition},"translate-comment":"Information about how much space has been used from users quota"}},[e._v("\n    %{used} of %{total}\n  ")])],1)};Z._withStripped=!0;const J=t.normalizeComponent({render:Z,staticRenderFns:[]},undefined,X,undefined,false,undefined,!1,void 0,void 0,void 0);let ee;const te={token:"",id:"",displayname:null,email:null,isAuthenticated:!1,capabilities:[],version:{},groups:[],userReady:!1,quota:null};var ie={state:te,actions:{cleanUpLoginState(e){""!==e.state.id&&(e.commit("SET_USER",te),e.commit("SET_CAPABILITIES",{capabilities:null,version:null}),e.commit("SET_USER_READY",!1),ee.clearLoginState())},async logout({dispatch:e}){const t=(t=!1)=>{e("cleanUpLoginState"),e("hideModal"),e("loadSettingsValues"),t&&Q.push({name:"login"})},i=await ee.getStoredUserObject();i&&i.id_token?ee.createSignoutRequest({id_token_hint:i.id_token}).then((e=>{t(),window.open(e,"_self")})).catch((e=>{console.error(e)})):t(!0)},async initAuth(e,t={autoRedirect:!1}){const i=async(i,a,n=!0)=>{const o={baseUrl:e.rootState.config.server||window.location.origin,auth:{bearer:a},headers:{"X-Requested-With":"XMLHttpRequest"}};if(e.state.id&&(o.userInfo={id:e.state.id,"display-name":e.state.displayname,email:e.state.email}),i.init(o),n){let n;try{n=await i.login()}catch(t){return console.warn("Seems that your token is invalid. Error:",t),e.dispatch("cleanUpLoginState"),void Q.push({name:"accessDenied"})}const o=await i.getCapabilities();e.commit("SET_CAPABILITIES",o);const s=await i.users.getUserGroups(n.id),r=await i.users.getUser(n.id);e.commit("SET_USER",{id:n.id,username:n.username,displayname:n.displayname||n["display-name"],email:Object.keys(n.email).length?n.email:"",token:a,isAuthenticated:!0,groups:s}),"default"!==r.quota.definition&&"none"!==r.quota.definition?(e.commit("SET_QUOTA",r.quota),e.commit("SET_SIDEBAR_FOOTER_CONTENT_COMPONENT",J,{root:!0})):e.commit("SET_SIDEBAR_FOOTER_CONTENT_COMPONENT",null,{root:!0}),await e.dispatch("loadSettingsValues"),e.commit("SET_USER_READY",!0),t.autoRedirect&&Q.push({path:"/"}).catch((()=>{}))}else e.commit("UPDATE_TOKEN",a)};if(!ee){ee=D(e.rootState.config);const t=this._vm.$client;ee.events().addAccessTokenExpired((function(){console.log("AccessToken Expired：",arguments)})),ee.mgr.events.addAccessTokenExpiring((function(){console.log("AccessToken Expiring：",arguments)})),ee.events().addUserLoaded((e=>{console.log(`New User Loaded. access_token： ${e.access_token}, refresh_token: ${e.refresh_token}`),i(t,e.access_token,!1)})),ee.events().addUserUnloaded((()=>{console.log("user unloaded…"),e.dispatch("cleanUpLoginState"),Q.push({name:"login"})})),ee.events().addSilentRenewError((t=>{console.error("Silent Renew Error：",t),e.dispatch("cleanUpLoginState"),Q.push({name:"accessDenied"})}))}const a=ee.getToken();a&&await i(this._vm.$client,a)},login(e,t={provider:"oauth2"}){ee=D(e.rootState.config),ee.authenticate(t.provider,{},{}).then((()=>{ee.isAuthenticated&&e.dispatch("initAuth")}))},callback(e){ee||(ee=D(e.rootState.config)),ee.mgr.signinRedirectCallback().then((()=>{e.dispatch("initAuth",{autoRedirect:!0})})).catch((t=>{console.warn("error in OpenIdConnect:",t),e.dispatch("cleanUpLoginState"),Q.push({name:"accessDenied"})}))},signinSilentCallback(e){ee||(ee=D(e.rootState.config)),ee.mgr.signinSilentCallback().then((()=>{e.dispatch("initAuth")}))}},mutations:{SET_USER(e,t){e.displayname=t.displayname,e.id=t.id,e.username=t.username,e.email=t.email,e.isAuthenticated=t.isAuthenticated,e.token=t.token,e.groups=t.groups},SET_CAPABILITIES(e,t){e.capabilities=t.capabilities,e.version=t.version},UPDATE_TOKEN(e,t){e.token=t},SET_USER_READY(e,t){e.userReady=t},SET_QUOTA(e,t){t.free=parseInt(t.free),t.relative=parseInt(t.relative),t.used=parseInt(t.used),t.total=parseInt(t.total),e.quota=t}},getters:{isAuthenticated:e=>e.isAuthenticated,getToken:e=>e.token,user:e=>e,capabilities:e=>e.capabilities,quota:e=>e.quota}};var ae={state:{urlBeforeLogin:null},actions:{saveUrlBeforeLogin({commit:e},t){e("SAVE_URL_BEFORE_LOGIN",t)}},mutations:{SAVE_URL_BEFORE_LOGIN(e,t){e.urlBeforeLogin=t}},getters:{urlBeforeLogin:e=>e.urlBeforeLogin}};var ne={state:{settingsValues:null},actions:{async loadSettingsValues({commit:e,state:t,dispatch:i}){const a=t.settingsValues;e("SET_SETTINGS_VALUES",null);try{e("SET_SETTINGS_VALUES",await this._vm.$client.settings.getSettingsValues())}catch(t){e("SET_SETTINGS_VALUES",a),i("showMessage",{title:"Failed to load settings values.",desc:t.response.statusText,status:"danger",autoClose:{enabled:!0}})}}},mutations:{SET_SETTINGS_VALUES(e,i){e.settingsValues=null===i?null:t.keyBy(i,"value.id")},SET_SETTINGS_VALUE(e,i){e.settingsValues=t.assign({},e.settingsValues,{[i.value.id]:i})}},getters:{settingsValuesLoaded:e=>null!==e.settingsValues,hasSettingsValue:(e,t)=>({settingId:e,extension:i,bundle:a,setting:n})=>null!==t.getSettingsValue({settingId:e,extension:i,bundle:a,setting:n}),getSettingsValue:(e,i)=>({settingId:a,extension:n,bundle:o,setting:s})=>{if(!i.settingsValuesLoaded)return null;if(a){const i=t.findKey(e.settingsValues,(e=>e.value.settingId===a));return t.isNil(i)?null:e.settingsValues[i].value}const r=t.findKey(e.settingsValues,(e=>t.isEqual(e.identifier,{extension:n,bundle:o,setting:s})));return t.isNil(r)?null:e.settingsValues[r].value}}};const oe=()=>{};var se={state:{displayed:!1,variation:"passive",icon:"",title:"",message:"",cancelText:"",confirmText:"",confirmDisabled:!1,hasInput:!1,inputDisabled:!1,inputValue:"",inputPlaceholder:"",inputLabel:"",inputError:"",onCancel:oe,onConfirm:oe,onInput:oe},actions:{createModal({commit:e},t){e("CREATE_MODAL",t)},hideModal({commit:e}){e("HIDE_MODAL")},setModalInputErrorMessage({commit:e},t){e("SET_INPUT_ERROR_MESSAGE",t)},toggleModalConfirmButton({commit:e}){e("TOGGLE_MODAL_CONFIRM_BUTTON")}},mutations:{CREATE_MODAL(e,t){e.displayed=!0,e.variation=t.variation||"passive",e.icon=t.icon,e.title=t.title,e.message=t.message,e.cancelText=t.cancelText||"Cancel",e.confirmText=t.confirmText||"Confirm",e.confirmDisabled=t.confirmDisabled||!1,e.onCancel=t.onCancel,e.onConfirm=t.onConfirm,e.hasInput=t.hasInput||!1,e.inputValue=t.inputValue||null,e.inputDescription=t.inputDescription||null,e.inputLabel=t.inputLabel||null,e.inputError=t.inputError||null,e.inputDisabled=t.inputDisabled||!1,e.onInput=t.onInput||oe},HIDE_MODAL(e){e.displayed=!1},SET_INPUT_ERROR_MESSAGE(e,t){e.inputError=t},TOGGLE_MODAL_CONFIRM_BUTTON(e){e.confirmDisabled=!e.confirmDisabled}}};var re={state:{staticNavItems:{},dynamicNavItems:{}},mutations:{SET_NAV_ITEMS_FROM_CONFIG(e,{extension:t,navItems:i}){const a=e.staticNavItems;a[t]=i,e.staticNavItems=a},ADD_NAV_ITEM(e,{extension:t,navItem:i}){const a={...e.dynamicNavItems};a[t]=a[t]||[];const n=a[t].findIndex((e=>e.route.path===i.route.path));n>=0?a[t][n]=i:a[t].push(i),e.dynamicNavItems=a}},getters:{getNavItemsByExtension:(e,t)=>i=>[...e.staticNavItems[i]||[],...e.dynamicNavItems[i]||[]].filter((e=>{if(!e.enabled)return!0;try{return e.enabled(t.capabilities)}catch(t){return console.error("`enabled` callback on navItem "+e.name+" threw an error",t),!1}})),getExtensionsWithNavItems:(e,t)=>[...new Set([...Object.keys(e.staticNavItems),...Object.keys(e.dynamicNavItems)])].filter((e=>t.getNavItemsByExtension(e).length>0))}};var ce={state:{sidebarFooterContentComponent:null},mutations:{SET_SIDEBAR_FOOTER_CONTENT_COMPONENT(e,t){e.sidebarFooterContentComponent=t}}};var le={plugins:[new t.VuexPersistence({key:"webStateInSessionStorage",storage:window.sessionStorage,reducer:e=>{const{userReady:t,...i}=e.user;return{user:i,router:e.router}}}).plugin],modules:{app:O,apps:F,user:ie,config:R,router:ae,settings:ne,modal:se,navigation:re,sidebar:ce},strict:!1};const de=[],ue="forward",pe="backward";var me={methods:{focus({from:e,to:t,revert:i}){const a=i?pe:ue;e&&a===ue?de.splice(0,de.length):e=document.activeElement,a===ue&&de.push(e),a===pe&&(t=de.pop()),t instanceof Element&&t.focus()}}},he={mounted(){this.$nextTick((()=>this.$emit("mounted",this,"mounted")))},beforeDestroy(){this.$emit("beforeDestroy",this,"beforeDestroy")},updated(){this.$nextTick((()=>this.$emit("updated",this,"updated")))}},ge={bind:function(e,t,i){window.event=function(a){e===a.target||e.contains(a.target)||i.context[t.expression](a)},document.body.addEventListener("click",window.event)},unbind:function(e){document.body.removeEventListener("click",window.event)}},fe={cs:{Account:"Účet","Account Information":"Informace o účtu","Application Switcher":"Přepínač Aplikací","Authentication failed":"Ověření selhalo",documentation:"dokumentace","Download failed":"Stahování selhalo",Edit:"Upravit","File could not be located":"Soubor se nepodařilo najít","For help visit our":"Pro pomoc navštivte naše",'If you like to login with a different user please proceed to <a id="exitAnchor">exit</a>.':'Pokud se chcete přihlásit jako jiný uživatel, pokračujte prosím <a id="exitAnchor">odhlášením</a>.',item:"položka","Loading folder failed…":"Načítání složky selhalo...","Log out":"Odhlásit",Login:"Přihlásit","Login Error":"Chyba přihlášení","No email has been set up":"Žádná emailová adresa nebyla nastavena",Notifications:"Oznámení","Open search bar":"Otevřít pole hledání","Please click the button below to authenticate and get access to your data.":"Stiskněte prosím tlačítko dole pro udělení oprávnění a zpřístupněte tak svá data.","Please contact the administrator if this error persists.":"Pokud tato chyba přetrvává, kontaktujte administrátora.","Please contact your administrator if you think this message shows up in error.":"Pokud si myslíte, že se tato zpráva zobrazuje omylem, kontaktujte svého administrátora.","Please wait a while. You are being redirected.":"Prosím vydržte chvíli. Probíhá přesměrování.",Profile:"Profil","Public link":"Veřejný odkaz",Redirecting:"Přesměrování","Search failed":"Hledání selhalo","Welcome to %{productName}":"Vítejte v %{productName}","You are not allowed to use this application.":"Tuto aplikaci nemáte povoleno používat.","You are not part of any group":"Nejste členem žádné skupiny"},de:{"{{ n.title }}":"{{ n.title }}","%{used} of %{total}":"%{used} von %{total}","<strong>Attention:</strong> this will log you out from all applications you are running in\n          this browser with your current user.":"<strong>Achtung:</strong> sie werden automatischen aus allen Anwendungen ausgeloggt.","Access denied":"Zugriff verweigert",Account:"Konto","Account Information":"Kontoinformationen","Account menu":"Benutzer-Menü","Also, make sure to check the browser console for more information.":"Bitte prüfen Sie auch die Browser-Konsole für weitere Informationen.","Application Switcher":"Apps-Menü","Authentication failed":"Authentifizierung fehlgeschlagen",chat:"chat","Close sidebar":"Seitenleiste schließen","Display name":"Anzeigename",documentation:"Dokumentation","Download failed":"Fehler beim Herunterladen",Edit:"Bearbeiten",Email:"E-Mail","Enter search query":"Suchbegriff eingeben","File could not be located":"Datei konnte nicht gefunden werden","For help visit our":"Für Hilfe besuche unsere","Group memberships":"Gruppenzugehörigkeiten",'If you like to login with a different user please proceed to <a id="exitAnchor">exit</a>.':'Wenn Sie sich mit einem anderen Benutzer anmelden möchten, gehen Sie bitte zu <a id="exitAnchor">exit</a>.',item:"Element",Loading:"Lädt","Loading folder failed…":"Laden des Ordners fehlgeschlagen…","Log out":"Abmelden",Login:"Login","Login Error":"Fehler beim Login","Main navigation":"Hauptnavigation","Missing or invalid config":"Fehlende oder falsche Konfiguration",msg:"Nachricht",n:"n","Navigate to all files page":'Zur Seite "Alle Dateien" navigieren',"Navigated to %{ pageTitle }":"Zur Seite %{ pageTitle } navigiert","No email has been set up":"Es wurde noch keine E-Mail eingerichtet",Notifications:"Benachrichtigungen","Oidc callback":"Oidc Callback","Oidc redirect":"Oidc Weiterleitung","Open navigation menu":"Navigationsmenü öffnen","Open search bar":"Suchleiste öffnen","or join our":"oder machen Sie mit bei ","Please check if the file config.json exists and is correct.":"Bitte prüfen Sie ob die config.json Konfigurationsdatei existiert und valide ist.","Please click the button below to authenticate and get access to your data.":"Klicken Sie auf die Schaltfläche unten, um sich zu authentifizieren und auf Ihre Daten zuzugreifen.","Please contact the administrator if this error persists.":"Bitte kontaktieren Sie den Administrator, wenn dieser Fehler weiterhin besteht.","Please contact your administrator if you think this message shows up in error.":"Falls diese Meldung fehlerhaft erscheint bitte die Systemverwaltung kontaktieren.","Please wait a while. You are being redirected.":"Bitte einen Moment Geduld. Sie werden weitergeleitet.","Private link":"Privater Link",Profile:"Profil","Public link":"Öffentlicher Link",Redirecting:"Weiterleiten",route:"Verbindung","Search failed":"Die Suche ist fehlgeschlagen","Sidebar footer":"Fußzeile der Seitenleiste","Sidebar header":"Kopfbereich der Seitenleiste","Sidebar navigation menu":"Navigation in der Seitenleiste","Skip to main":"Zum Hauptinhalt springen",this:"dies","Top bar":"Kopfleiste","User ID":"Nutzer ID","User Menu":"Benutzermenü",Username:"Nutzername","Welcome to %{productName}":"Willkommen zu %{productName}","You are not allowed to use this application.":"Keine Berechtigung zur Benutzung dieser Applikation.","You are not part of any group":"Sie gehören keiner Gruppe an."},es:{Account:"Cuenta","Account Information":"Información de cuenta","Authentication failed":"Fallo de autenticación",documentation:"documentación","Download failed":"Descarga fallida",Edit:"Editar","For help visit our":"Para ayuda visite nuestra",'If you like to login with a different user please proceed to <a id="exitAnchor">exit</a>.':'Si deseas entrar con un nombre de usuario distinto por favor procede a <a id="exitAnchor">salir</a>.',Loading:"Cargando","Loading folder failed…":"Falló la subida de la carpeta...","Log out":"Salir",Login:"Iniciar sesión","Login Error":"Error de inicio de sesión",msg:"msg","No email has been set up":"No se ha establecido ningún correo electrónico","Please click the button below to authenticate and get access to your data.":"Pulse el botón para autenticarse y ganar acceso a sus datos.","Please contact the administrator if this error persists.":"Contacta con el administrador si el error persiste","Please contact your administrator if you think this message shows up in error.":"Póngase en contacto con su administrador si cree que este mensaje aparece por error.","Please wait a while. You are being redirected.":"Por favor espere. Lo estamos redireccionando.",Redirecting:"Redireccionando","Search failed":"Falló la búsqueda",this:"esto","Welcome to %{productName}":"Bienvenido a %{productName} ","You are not allowed to use this application.":"No se le permite usar esta aplicación.","You are not part of any group":"No eres parte de ningún grupo"},fr:{"%{used} of %{total}":"%{used} sur %{total}",Account:"Compte","Account Information":"Informations de compte","Application Switcher":" Changeur d'applications","Authentication failed":"Error d'authentification",documentation:"documentation","Download failed":"Echec de téléchargement",Edit:"Editer","File could not be located":"Le fichier n'a pas été trouvé","For help visit our":"Pour de l'aide visiter notre ",'If you like to login with a different user please proceed to <a id="exitAnchor">exit</a>.':'Pour vous connecter avec un utilisateur différent, veuillez procéder à la <a id="exitAnchor">sortie</a>.',Loading:"Chargement","Loading folder failed…":"Erreur de chargement du dossier…","Log out":"Se déconnecter",Login:"Se connecter","Login Error":"Erreur de connection",msg:"msg","No email has been set up":"Pas d'adresse e-mail configurée",Notifications:"Notifications","Please click the button below to authenticate and get access to your data.":"Veuillez cliquer le button ci-dessous pour vous authentifier et obtenir accès à vos données.","Please contact the administrator if this error persists.":"Veuillez contacter l'administrateur si cette erreur persiste.","Please contact your administrator if you think this message shows up in error.":"Veuillez contacter l'administrateur si vous pensez que ce message apparaît par erreur.","Please wait a while. You are being redirected.":"Veuillez patienter. Redirection en cours.",Profile:"Profil","Public link":"Lien public",Redirecting:"Redirection en cours","Search failed":"Échec de la recherche","Welcome to %{productName}":"Bienvenue sur %{productName}","You are not allowed to use this application.":"Vous n'êtes pas autorisé à utiliser cette application.","You are not part of any group":"Vous n'êtes membre d'aucun groupe"},gl:{"%{used} of %{total}":"%{used} de %{total}",Account:"Conta","Account Information":"Información da conta","Application Switcher":"Cambiador de aplicacións","Authentication failed":"Produciuse un fallo de autenticación",documentation:"documentación","Download failed":"Produciuse un fallo na descarga",Edit:"Editar","File could not be located":"Non foi posíbel localizar o ficheiro","For help visit our":"Para obter axuda visite o noso",'If you like to login with a different user please proceed to <a id="exitAnchor">exit</a>.':'Se quere iniciar sesión cun usuario diferente, proceda a <a id="exitAnchor">saír</a>.',item:"elemento",Loading:"Cargando","Loading folder failed…":"Produciuse un fallo ao cargar o cartafol…","Log out":"Saír",Login:"Acceso","Login Error":"Produciuse un erro de acceso",msg:"msx","No email has been set up":"Non se configurou ningún correo-e",Notifications:"Notificacións","Open search bar":"Abrir a barra de busca","Please click the button below to authenticate and get access to your data.":"Prema no botón de embaixo para autenticarse e obter acceso aos seus datos.","Please contact the administrator if this error persists.":"Póñase en contacto co seu administrador se persiste o erro.","Please contact your administrator if you think this message shows up in error.":"Póñase en contacto co seu administrador se cre que esta mensaxe aparece por erro.","Please wait a while. You are being redirected.":"Agarde un chisco. Está a ser redirixido.",Profile:"Perfil","Public link":"Ligazón pública",Redirecting:"Redirixindo","Search failed":"Produciuse un fallo na busca",this:"este","Welcome to %{productName}":"Benvido a %{productName}","You are not allowed to use this application.":"Non ten permiso para empregar esta aplicación","You are not part of any group":"Vostede non forma parte de ningún grupo"},it:{}},ve={install(e){function i(t,i="url",a=null){return new Promise(((n,o)=>{null===a&&(a=new Headers).append("Authorization","Bearer "+e.$store.getters.getToken),a.append("X-Requested-With","XMLHttpRequest"),fetch(t,{headers:a}).then((e=>{e.ok?e.blob().then((e=>{if("base64"===i){const t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){n(t)}}else if("url"===i){const t=window.URL.createObjectURL(e);n(t)}})):o(e)})).catch((e=>{console.warn("media-source",e),o(e)}))}))}function a(e,t){e.setAttribute("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=");const a=t.value;e.setAttribute("data-image-source",a),i(a).then((t=>{a===e.getAttribute("data-image-source")?e.setAttribute("src",t):console.warn("image-source was updated again before image could load")})).catch((e=>{console.warn("image-source",e)}))}e.directive("image-source",{bind(e,t){a(e,t)},update(e,t){t.value!==t.oldValue&&a(e,t)}}),e.mixin({data:function(){return{mediaSourceQueue:new t._default({concurrency:2})}},methods:{mediaSource(e,t="url",a=null){return this.mediaSourceQueue.add((()=>i(e,t,a)))}}})}},be={install(e){e.mixin({computed:{...t.mapGetters$1(["getToken","isAuthenticated","capabilities"]),...t.mapGetters$1("Files",["publicLinkPassword"]),...t.mapGetters$1(["configuration"]),currentExtension(){return this.$route.path.split("/")[1]},isUrlSigningEnabled(){return this.capabilities.core&&this.capabilities.core["support-url-signing"]}},methods:{...t.mapActions$1("Files",["addActionToProgress","removeActionFromProgress"]),...t.mapActions$1(["showMessage"]),publicPage(){return!this.isAuthenticated||!1===this.$route.meta.auth},async downloadFile(e,t=null,i=null){const a=null!==t?t:this.publicPage();let n=null,o={};if(a?n=e.downloadURL:(n=null===i?this.$client.helpers._webdavUrl+e.path:this.$client.fileVersions.getFileVersionUrl(e.id,i),o={Authorization:"Bearer "+this.getToken}),a||!this.isUrlSigningEnabled)this.triggerDownload(n,e.name);else{try{if(200===(await fetch(n,{method:"HEAD",headers:o})).status){const t=await this.$client.signUrl(n);return void this.triggerDownload(t,e.name)}}catch(e){console.log(e)}this.showMessage({title:this.$gettext("Download failed"),desc:this.$gettext("File could not be located"),status:"danger",autoClose:{enabled:!0}})}},isIE11:()=>!!window.MSInputMethodContext&&!!document.documentMode,encodePath:i.encodePath,triggerDownload(e,t){const i=document.createElement("a");i.style.display="none",document.body.appendChild(i),i.href=e,i.setAttribute("download",t),i.click(),document.body.removeChild(i)}}})}},_e={install(e){e.mixin({computed:{browserSupportsChunked:()=>t.lib_es5.isSupported},methods:{uploadChunkedFile(e,i,a){return new Promise(((n,o)=>{const s=this.$client.helpers.buildHeaders();delete s["OCS-APIREQUEST"];let r=null;e.lastModifiedDate&&(r=e.lastModifiedDate.getTime()/1e3),e.lastModified&&(r=e.lastModified/1e3);const c=new t.lib_es5.Upload(e,{endpoint:this.$client.files.getFileUrlV2(i),headers:s,chunkSize:a.chunkSize||1/0,removeFingerprintOnSuccess:!0,overridePatchMethod:!!a.overridePatchMethod,retryDelays:[0,3e3,5e3,1e4,2e4],metadata:{filename:e.name,filetype:e.type,size:e.size,mtime:r},onError:t=>{console.error(`Error uploading file "${e}" to "${i}"`,t),o(t)},onProgress:(e,t)=>{a.emitProgress({loaded:e,total:t})},onSuccess:()=>{n(`File ${c.file.name} was successfully uploaded`)}});return c.start(),c}))}}})}};const ke={name:"Avatar",props:{type:{type:String,default:"div",validator:e=>e.match(/(div|span)/)},userName:{type:String,default:""},userid:{type:String,default:""},width:{type:Number,required:!1,default:42}},data:()=>({avatarSource:"",loading:!0}),computed:{...t.mapGetters$1(["getToken","configuration"]),enabled:function(){return this.configuration.enableAvatars||!0}},watch:{userid:function(e,t){this.setUser(e)}},mounted:function(){""!==this.userid?this.setUser(this.userid):this.loading=!1},methods:{setUser(e){if(this.loading=!0,this.avatarSource="",!this.enabled||""===e)return void(this.loading=!1);const t=new Headers,i=(this.configuration.server||window.location.origin)+"remote.php/dav/avatars/"+this.userid+"/128.png";t.append("Authorization","Bearer "+this.getToken),t.append("X-Requested-With","XMLHttpRequest"),fetch(i,{headers:t}).then((e=>{if(e.ok)return e.blob();if(404!==e.status)throw new Error(`Unexpected status code ${e.status}`)})).then((e=>{this.loading=!1,this.avatarSource=e?window.URL.createObjectURL(e):""})).catch((e=>{this.avatarSource="",this.loading=!1,console.error(`Error loading avatar image for user "${this.userid}": `,e.message)}))}}};var we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.enabled?i(e.type,{tag:"component",attrs:{"aria-hidden":!0}},[e.loading?i("oc-spinner",{key:"avatar-loading",style:"width: "+e.width+"px; height: "+e.width+"px;"}):i("oc-avatar",{key:"avatar-loaded",attrs:{width:e.width,src:e.avatarSource,"user-name":e.userName}})],1):e._e()};we._withStripped=!0;const Se=t.normalizeComponent({render:we,staticRenderFns:[]},undefined,ke,undefined,false,undefined,!1,void 0,void 0,void 0);async function ye(e){const t=sessionStorage.getItem("dynamicClientData");if(null!==t){const e=t.client_secret_expires_at||0;if(0===e||Date.now()<1e3*e)return JSON.parse(t)}sessionStorage.removeItem("dynamicClientData");let i=window.location.href.split("#")[0];i.endsWith("/index.html")&&(i=i.substr(0,i.length-10));const a=await async function(e){return await fetch(e).then((e=>e.json())).catch((e=>{console.log("Error: ",e)}))}(`${e.authority}/.well-known/openid-configuration`),n=await async function(e,t){return await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).catch((e=>{console.log("Error: ",e)}))}(a.registration_endpoint,{redirect_uris:[i+"oidc-callback.html"],client_name:`ownCloud Web on ${i}`});return sessionStorage.setItem("dynamicClientData",JSON.stringify(n)),n}t.Vue.prototype.$client=new t.OwnCloud,t.Vue.use(t._default$1),t.Vue.use(t.index),t.Vue.use(t.VueRouter),t.Vue.use(t.vueScrollto),t.Vue.use(ve),t.Vue.use(be),t.Vue.use(t.plugin),t.Vue.use(t.index$1,{refreshOnceOnNavigation:!0}),t.Vue.use(_e),t.Vue.use(t.vue2TouchEvents),t.Vue.component("drag",t.vueDragDrop_common.Drag),t.Vue.component("drop",t.vueDragDrop_common.Drop),t.Vue.component("avatar-image",Se),t.Vue.mixin(me),t.Vue.mixin(he),t.Vue.directive("click-outside",ge);const Ee=t.lib.createStore(t.index.Store,{...le});let Ie;const xe={en:"English",de:"Deutsch",es:"Español",cs:"Czech",fr:"Français",it:"Italiano",gl:"Galego"},Ce=t.merge({},fe,t.odsTranslations),Ae=async e=>{const t=await new Promise(((t,i)=>requirejs([e],(e=>t(e)),(e=>i(e)))));if(!t.appInfo)throw new Error("Skipping without appInfo for app "+e);t.routes&&(t.routes=t.routes.map((e=>(e.name=t.appInfo.id===e.name?e.name:`${t.appInfo.id}-${e.name}`,e.path=`/${encodeURI(t.appInfo.id)}${e.path}`,e.children&&(e.children=e.children.map((e=>(e.name=`${t.appInfo.id}-${e.name}`,e)))),e))),Q.addRoutes(t.routes)),t.navItems&&Ee.commit("SET_NAV_ITEMS_FROM_CONFIG",{extension:t.appInfo.id,navItems:t.navItems}),t.translations&&Object.keys(xe).forEach((e=>{Ce[e]&&t.translations[e]&&Object.assign(Ce[e],t.translations[e])})),t.quickActions&&Ee.commit("ADD_QUICK_ACTIONS",t.quickActions),t.store&&Ee.registerModule(t.appInfo.name,t.store.default||t.store),await Ee.dispatch("registerApp",t.appInfo)},Ne=async e=>{const{theme:i}=await(async(e="")=>{const i={theme:t.defaultTheme};if("json"!==e.split(".").pop())return i;let a;try{a=await fetch(e)}catch(e){return i}return a.ok?{theme:await a.json()}:i})(e);await Ee.dispatch("loadTheme",{theme:i.default}),t.Vue.use(t.DesignSystem,{tokens:Ee.getters.theme.designTokens})},Te=()=>{t.Vue.use(t.GetTextPlugin,{availableLanguages:xe,defaultLanguage:navigator.language.substring(0,2),translations:Ce,silent:!0})};e.exec=async()=>{try{Ie=await(async()=>{let e=await fetch("config.json");if(200!==e.status)throw new Error(`config could not be loaded. HTTP status-code ${e.status}`);try{e=await e.json()}catch(e){throw new Error(`config could not be parsed. ${e}`)}return e})()}catch(e){return console.log(e),Q.push("missing-config"),void(async()=>{Te(),await Ne(),new t.Vue({el:"#owncloud",store:Ee,render:e=>e($)})})()}try{if(Ie.openIdConnect&&Ie.openIdConnect.dynamic){const e=await ye(Ie.openIdConnect);Ie.openIdConnect.client_id=e.client_id,Ie.openIdConnect.client_secret=e.client_secret}const e=Ie.apps.map((e=>`web-app-${e}`));Ie.external_apps&&e.push(...Ie.external_apps.map((e=>e.path))),requirejs.s.contexts._.config.waitSeconds=200;for(const t of e)try{await Ae(t)}catch(e){console.error("failed to load app "+t,e)}await(async()=>{const e=Ee.getters.appIds;let i=Ee.getters.configuration.options.defaultExtension;(!i||e.indexOf(i)<0)&&(i=e[0]),Q.addRoutes([{path:"/",redirect:()=>Ee.getters.getNavItemsByExtension(i)[0].route}]),t.sync(Ee,Q),await Ee.dispatch("loadConfig",Ie),t.Vue.prototype.$client.init({baseUrl:Ie.server||window.location.origin}),await Ne(Ie.theme),Te(),t.Vue.$store=Ee,new t.Vue({el:"#owncloud",store:Ee,router:Q,render:e=>e(N)})})()}catch(e){console.log(e)}},Object.defineProperty(e,"__esModule",{value:!0})}));
